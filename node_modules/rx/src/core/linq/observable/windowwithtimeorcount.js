  /**
   *  Projects each element of an observable sequence into a window that is completed when either it's full or a given amount of time has elapsed.
   * @param ***REMOVED***Number***REMOVED*** timeSpan Maximum time length of a window.
   * @param ***REMOVED***Number***REMOVED*** count Maximum element count of a window.
   * @param ***REMOVED***Scheduler***REMOVED*** [scheduler]  Scheduler to run windowing timers on. If not specified, the timeout scheduler is used.
   * @returns ***REMOVED***Observable***REMOVED*** An observable sequence of windows.
   */
  observableProto.windowWithTimeOrCount = function (timeSpan, count, scheduler) ***REMOVED***
    var source = this;
    isScheduler(scheduler) || (scheduler = timeoutScheduler);
    return new AnonymousObservable(function (observer) ***REMOVED***
      var timerD = new SerialDisposable(),
          groupDisposable = new CompositeDisposable(timerD),
          refCountDisposable = new RefCountDisposable(groupDisposable),
          n = 0,
          windowId = 0,
          s = new Subject();

      function createTimer(id) ***REMOVED***
        var m = new SingleAssignmentDisposable();
        timerD.setDisposable(m);
        m.setDisposable(scheduler.scheduleWithRelative(timeSpan, function () ***REMOVED***
          if (id !== windowId) ***REMOVED*** return; ***REMOVED***
          n = 0;
          var newId = ++windowId;
          s.onCompleted();
          s = new Subject();
          observer.onNext(addRef(s, refCountDisposable));
          createTimer(newId);
        ***REMOVED***));
      ***REMOVED***

      observer.onNext(addRef(s, refCountDisposable));
      createTimer(0);

      groupDisposable.add(source.subscribe(
        function (x) ***REMOVED***
          var newId = 0, newWindow = false;
          s.onNext(x);
          if (++n === count) ***REMOVED***
            newWindow = true;
            n = 0;
            newId = ++windowId;
            s.onCompleted();
            s = new Subject();
            observer.onNext(addRef(s, refCountDisposable));
          ***REMOVED***
          newWindow && createTimer(newId);
        ***REMOVED***,
        function (e) ***REMOVED***
          s.onError(e);
          observer.onError(e);
        ***REMOVED***, function () ***REMOVED***
          s.onCompleted();
          observer.onCompleted();
        ***REMOVED***
      ));
      return refCountDisposable;
    ***REMOVED***, source);
  ***REMOVED***;
