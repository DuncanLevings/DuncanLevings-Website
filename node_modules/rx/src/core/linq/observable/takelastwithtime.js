  /**
   *  Returns elements within the specified duration from the end of the observable source sequence, using the specified schedulers to run timers and to drain the collected elements.
   * @description
   *  This operator accumulates a queue with a length enough to store elements received during the initial duration window.
   *  As more elements are received, elements older than the specified duration are taken from the queue and produced on the
   *  result sequence. This causes elements to be delayed with duration.
   * @param ***REMOVED***Number***REMOVED*** duration Duration for taking elements from the end of the sequence.
   * @param ***REMOVED***Scheduler***REMOVED*** [scheduler]  Scheduler to run the timer on. If not specified, defaults to Rx.Scheduler.timeout.
   * @returns ***REMOVED***Observable***REMOVED*** An observable sequence with the elements taken during the specified duration from the end of the source sequence.
   */
  observableProto.takeLastWithTime = function (duration, scheduler) ***REMOVED***
    var source = this;
    isScheduler(scheduler) || (scheduler = timeoutScheduler);
    return new AnonymousObservable(function (o) ***REMOVED***
      var q = [];
      return source.subscribe(function (x) ***REMOVED***
        var now = scheduler.now();
        q.push(***REMOVED*** interval: now, value: x ***REMOVED***);
        while (q.length > 0 && now - q[0].interval >= duration) ***REMOVED***
          q.shift();
        ***REMOVED***
      ***REMOVED***, function (e) ***REMOVED*** o.onError(e); ***REMOVED***, function () ***REMOVED***
        var now = scheduler.now();
        while (q.length > 0) ***REMOVED***
          var next = q.shift();
          if (now - next.interval <= duration) ***REMOVED*** o.onNext(next.value); ***REMOVED***
        ***REMOVED***
        o.onCompleted();
      ***REMOVED***);
    ***REMOVED***, source);
  ***REMOVED***;
