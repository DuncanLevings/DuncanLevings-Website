  /**
   *  Represents a value that changes over time.
   *  Observers can subscribe to the subject to receive the last (or initial) value and all subsequent notifications.
   */
  var BehaviorSubject = Rx.BehaviorSubject = (function (__super__) ***REMOVED***
    function subscribe(observer) ***REMOVED***
      checkDisposed.call(this);
      if (!this.isStopped) ***REMOVED***
        this.observers.push(observer);
        observer.onNext(this.value);
        return new InnerSubscription(this, observer);
      ***REMOVED***
      if (this.hasError) ***REMOVED***
        observer.onError(this.error);
      ***REMOVED*** else ***REMOVED***
        observer.onCompleted();
      ***REMOVED***
      return disposableEmpty;
    ***REMOVED***

    inherits(BehaviorSubject, __super__);

    /**
     *  Initializes a new instance of the BehaviorSubject class which creates a subject that caches its last value and starts with the specified value.
     *  @param ***REMOVED***Mixed***REMOVED*** value Initial value sent to observers when no other value has been received by the subject yet.
     */
    function BehaviorSubject(value) ***REMOVED***
      __super__.call(this, subscribe);
      this.value = value,
      this.observers = [],
      this.isDisposed = false,
      this.isStopped = false,
      this.hasError = false;
    ***REMOVED***

    addProperties(BehaviorSubject.prototype, Observer, ***REMOVED***
      /**
       * Indicates whether the subject has observers subscribed to it.
       * @returns ***REMOVED***Boolean***REMOVED*** Indicates whether the subject has observers subscribed to it.
       */
      hasObservers: function () ***REMOVED*** return this.observers.length > 0; ***REMOVED***,
      /**
       * Notifies all subscribed observers about the end of the sequence.
       */
      onCompleted: function () ***REMOVED***
        checkDisposed.call(this);
        if (this.isStopped) ***REMOVED*** return; ***REMOVED***
        this.isStopped = true;
        for (var i = 0, os = this.observers.slice(0), len = os.length; i < len; i++) ***REMOVED***
          os[i].onCompleted();
        ***REMOVED***

        this.observers.length = 0;
      ***REMOVED***,
      /**
       * Notifies all subscribed observers about the exception.
       * @param ***REMOVED***Mixed***REMOVED*** error The exception to send to all observers.
       */
      onError: function (error) ***REMOVED***
        checkDisposed.call(this);
        if (this.isStopped) ***REMOVED*** return; ***REMOVED***
        this.isStopped = true;
        this.hasError = true;
        this.error = error;

        for (var i = 0, os = this.observers.slice(0), len = os.length; i < len; i++) ***REMOVED***
          os[i].onError(error);
        ***REMOVED***

        this.observers.length = 0;
      ***REMOVED***,
      /**
       * Notifies all subscribed observers about the arrival of the specified element in the sequence.
       * @param ***REMOVED***Mixed***REMOVED*** value The value to send to all observers.
       */
      onNext: function (value) ***REMOVED***
        checkDisposed.call(this);
        if (this.isStopped) ***REMOVED*** return; ***REMOVED***
        this.value = value;
        for (var i = 0, os = this.observers.slice(0), len = os.length; i < len; i++) ***REMOVED***
          os[i].onNext(value);
        ***REMOVED***
      ***REMOVED***,
      /**
       * Unsubscribe all observers and release resources.
       */
      dispose: function () ***REMOVED***
        this.isDisposed = true;
        this.observers = null;
        this.value = null;
        this.exception = null;
      ***REMOVED***
    ***REMOVED***);

    return BehaviorSubject;
  ***REMOVED***(Observable));
