const spawn = require('child_process').spawn;

module.exports = function(rootPid, callback) ***REMOVED***
  const tree = ***REMOVED******REMOVED***;
  var output = '';

  // *nix
  const ps = spawn('ps', ['-A', '-o', 'ppid,pid']);
  ps.stdout.on('data', data => ***REMOVED***
    output += data.toString('ascii');
  ***REMOVED***);

  ps.on('close', () => ***REMOVED***
    try ***REMOVED***
      const res = output
        .split('\n')
        .slice(1)
        .map(_ => _.trim())
        .reduce((acc, line) => ***REMOVED***
          if (line.indexOf(rootPid + ' ') === 0) ***REMOVED***
            const pid = line.split(/\s+/).pop();
            acc.push(parseInt(pid, 10));
            rootPid = pid;
          ***REMOVED***

          return acc;
        ***REMOVED***, []);

      callback(null, res);
    ***REMOVED*** catch (e) ***REMOVED***
      callback(e, null);
    ***REMOVED***
  ***REMOVED***);
***REMOVED***;
